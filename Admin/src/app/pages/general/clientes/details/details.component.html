<div class="details-container">
  <!-- Contenedor de alertas flotantes -->
  <div class="alert-container">
    <div
      *ngIf="mostrarAlertaError"
      class="alert alert-danger alert-border-left alert-dismissible fade show floating-alert"
      role="alert"
    >
      <i class="ri-error-warning-line me-3 align-middle fs-lg"></i>
      <strong>¡Error!</strong> {{ mensajeError }}
      <button
        type="button"
        class="btn-close"
        (click)="cerrarAlerta()"
        aria-label="Close"
      ></button>
    </div>
  </div>

  <!-- Botón de regresar -->
  <div class="details-header-button">
    <button type="button" class="btn btn-primary mb-3" (click)="cerrar()">
      <span class="btn-text">Regresar</span>
      <span class="btn-icon"><i class="ri-arrow-left-line"></i></span>
    </button>
  </div>

  <!-- Contenido de detalles -->
  <div *ngIf="!cargando && clienteDetalle" class="details-content">
    <div class="row g-4 align-items-stretch">
      <!-- Card izquierda: Imagen negocio + nombre -->
      <div class="col-md-4">
        <div class="card h-100 shadow-sm employee-photo-card position-relative">
          <ng-container
            *ngIf="clienteDetalle?.clie_ImagenDelNegocio; else noImage"
          >
            <img
              [src]="clienteDetalle.clie_ImagenDelNegocio"
              alt="Imagen del negocio"
              class="employee-img-card"
            />
            <div class="employee-img-overlay">
              <span class="employee-img-name">{{
                clienteDetalle.clie_NombreNegocio
              }}</span>
            </div>
          </ng-container>
          <ng-template #noImage>
            <div
              class="employee-img-placeholder-card d-flex flex-column justify-content-center align-items-center h-100"
            >
              <i class="ri-store-2-line display-1"></i>
              <span class="employee-img-name mt-3">{{
                clienteDetalle.clie_NombreNegocio
              }}</span>
            </div>
          </ng-template>
        </div>
      </div>

      <!-- Card derecha: Detalles del cliente -->
      <div class="col-md-8">
        <div class="card h-100 shadow-sm employee-details-card bg-dark-blue">
          <div
            class="card-header d-flex align-items-center rounded-top details-header-custom"
          >
            <i class="ri-user-3-line me-2 fs-4"></i>
            <h5 class="mb-0">Detalles del Cliente</h5>
          </div>
          <div class="card-body">
            <div class="row g-3">
              <div class="col-12 col-sm-6" *ngIf="clienteDetalle.clie_Codigo">
                <div class="detail-item">
                  <div class="detail-icon bg-dark-blue text-white">
                    <i class="ri-hashtag"></i>
                  </div>
                  <div class="detail-content">
                    <div class="detail-label">Código</div>
                    <div class="detail-value">
                      {{ clienteDetalle.clie_Codigo }}
                    </div>
                  </div>
                </div>
              </div>

              <div class="col-12 col-sm-6">
                <div class="detail-item">
                  <div class="detail-icon bg-dark-blue text-white">
                    <i class="ri-user-line"></i>
                  </div>
                  <div class="detail-content">
                    <div class="detail-label">Nombre completo</div>
                    <div class="detail-value">
                      {{ clienteDetalle.clie_Nombres }}
                      {{ clienteDetalle.clie_Apellidos }}
                    </div>
                  </div>
                </div>
              </div>

              <div class="col-12 col-sm-6">
                <div class="detail-item">
                  <div class="detail-icon bg-dark-blue text-white">
                    <i class="ri-passport-line"></i>
                  </div>
                  <div class="detail-content">
                    <div class="detail-label">DNI</div>
                    <div class="detail-value">
                      {{ clienteDetalle.clie_DNI }}
                    </div>
                  </div>
                </div>
              </div>

              <div class="col-12 col-sm-6">
                <div class="detail-item">
                  <div class="detail-icon bg-dark-blue text-white">
                    <i class="ri-mail-line"></i>
                  </div>
                  <div class="detail-content">
                    <div class="detail-label">Correo</div>
                    <div class="detail-value">
                      {{ clienteDetalle.clie_Correo }}
                    </div>
                  </div>
                </div>
              </div>

              <div class="col-12 col-sm-6">
                <div class="detail-item">
                  <div class="detail-icon bg-dark-blue text-white">
                    <i class="ri-phone-line"></i>
                  </div>
                  <div class="detail-content">
                    <div class="detail-label">Teléfono</div>
                    <div class="detail-value">
                      {{ clienteDetalle.clie_Telefono }}
                    </div>
                  </div>
                </div>
              </div>

              <div class="col-12 col-sm-6">
                <div class="detail-item">
                  <div class="detail-icon bg-dark-blue text-white">
                    <i
                      [ngClass]="{
                        'ri-men-line': clienteDetalle.clie_Sexo === 'M',
                        'ri-women-line': clienteDetalle.clie_Sexo === 'F',
                        'ri-gender-line':
                          clienteDetalle.clie_Sexo !== 'M' &&
                          clienteDetalle.clie_Sexo !== 'F'
                      }"
                    >
                    </i>
                  </div>
                  <div class="detail-content">
                    <div class="detail-label">Sexo</div>
                    <div class="detail-value">
                      {{
                        clienteDetalle.clie_Sexo === "M"
                          ? "Masculino"
                          : clienteDetalle.clie_Sexo === "F"
                          ? "Femenino"
                          : clienteDetalle.clie_Sexo
                      }}
                    </div>
                  </div>
                </div>
              </div>

              <div class="col-12 col-sm-6">
                <div class="detail-item">
                  <div class="detail-icon bg-dark-blue text-white">
                    <i class="ri-calendar-line"></i>
                  </div>
                  <div class="detail-content">
                    <div class="detail-label">Fecha de nacimiento</div>
                    <div class="detail-value">
                      {{ clienteDetalle.clie_FechaNacimiento }}
                    </div>
                  </div>
                </div>
              </div>

              <div
                class="col-12 col-sm-6"
                *ngIf="clienteDetalle.pais_Descripcion"
              >
                <div class="detail-item">
                  <div class="detail-icon bg-dark-blue text-white">
                    <i class="ri-flag-line"></i>
                  </div>
                  <div class="detail-content">
                    <div class="detail-label">País de nacimiento</div>
                    <div class="detail-value">
                      {{ clienteDetalle.pais_Descripcion }}
                    </div>
                  </div>
                </div>
              </div>

              <div
                class="col-12 col-sm-6"
                *ngIf="clienteDetalle.tiVi_Descripcion"
              >
                <div class="detail-item">
                  <div class="detail-icon bg-dark-blue text-white">
                    <i class="ri-community-line"></i>
                  </div>
                  <div class="detail-content">
                    <div class="detail-label">Localidad</div>
                    <div class="detail-value">
                      {{ clienteDetalle.tiVi_Descripcion }}
                    </div>
                  </div>
                </div>
              </div>

              <div
                class="col-12 col-sm-6"
                *ngIf="clienteDetalle.cana_Descripcion"
              >
                <div class="detail-item">
                  <div class="detail-icon bg-dark-blue text-white">
                    <i class="ri-team-line"></i>
                  </div>
                  <div class="detail-content">
                    <div class="detail-label">Canal</div>
                    <div class="detail-value">
                      {{ clienteDetalle.cana_Descripcion }}
                    </div>
                  </div>
                </div>
              </div>

              <div
                class="col-12 col-sm-6"
                *ngIf="clienteDetalle.ruta_Descripcion"
              >
                <div class="detail-item">
                  <div class="detail-icon bg-dark-blue text-white">
                    <i class="ri-route-line"></i>
                  </div>
                  <div class="detail-content">
                    <div class="detail-label">Ruta</div>
                    <div class="detail-value">
                      {{ clienteDetalle.ruta_Descripcion }}
                    </div>
                  </div>
                </div>
              </div>

              <div
                class="col-12 col-sm-6"
                *ngIf="clienteDetalle.esCv_Descripcion"
              >
                <div class="detail-item">
                  <div class="detail-icon bg-dark-blue text-white">
                    <i class="ri-hand-heart-line"></i>
                  </div>
                  <div class="detail-content">
                    <div class="detail-label">Estado Civil</div>
                    <div class="detail-value">
                      {{ clienteDetalle.esCv_Descripcion }}
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Sección de direcciones -->
    <h4 class="details-title mt-4 mb-3" style="color: black">
      Direcciones del Cliente
    </h4>
    <div class="row g-3">
      <div class="col-md-6" *ngFor="let direccion of direcciones">
        <div class="detail-item">
          <div class="detail-icon bg-dark-blue text-white">
            <i class="ri-map-pin-line"></i>
          </div>
          <div class="detail-content">
            <div class="detail-label">Colonia</div>
            <div class="detail-value">
              {{ obtenerDescripcionColonia(direccion.colo_Id) }}
            </div>
          </div>
        </div>
      </div>

      <div class="col-md-6" *ngFor="let direccion of direcciones">
        <div class="detail-item">
          <div class="detail-icon bg-dark-blue text-white">
            <i class="ri-compass-line"></i>
          </div>
          <div class="detail-content">
            <div class="detail-label">Referencia</div>
            <div class="detail-value">{{ direccion.diCl_Observaciones }}</div>
          </div>
        </div>
      </div>

      <div class="col-md-6" *ngFor="let direccion of direcciones">
        <div class="detail-item">
          <div class="detail-icon bg-dark-blue text-white">
            <i class="ri-focus-line"></i>
          </div>
          <div class="detail-content">
            <div class="detail-label">Latitud</div>
            <div class="detail-value">
              {{ direccion.diCl_Latitud | number : "1.6-6" }}
            </div>
          </div>
        </div>
      </div>

      <div class="col-md-6" *ngFor="let direccion of direcciones">
        <div class="detail-item">
          <div class="detail-icon bg-dark-blue text-white">
            <i class="ri-focus-line"></i>
          </div>
          <div class="detail-content">
            <div class="detail-label">Longitud</div>
            <div class="detail-value">
              {{ direccion.diCl_Longitud | number : "1.6-6" }}
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Historial de auditoría -->
    <h4 class="details-title mt-4 mb-3" style="color: black">
      Historial de acciones
    </h4>
    <div class="audit-table-container">
      <div class="audit-table">
        <div class="audit-header">
          <div class="audit-col">Acción</div>
          <div class="audit-col">Usuario</div>
          <div class="audit-col">Fecha</div>
        </div>

        <div class="audit-row">
          <div class="audit-col"><span class="audit-action">Creador</span></div>
          <div class="audit-col">
            <span class="audit-user">{{
              clienteDetalle.usuaC_Nombre || "N/A"
            }}</span>
          </div>
          <div class="audit-col">
            <span class="audit-date">{{
              formatearFecha(clienteDetalle.clie_FechaCreacion)
            }}</span>
          </div>
        </div>

        <div class="audit-row">
          <div class="audit-col">
            <span class="audit-action">Modificación</span>
          </div>
          <div class="audit-col">
            <span class="audit-user">{{
              clienteDetalle.usuaM_Nombre || "N/A"
            }}</span>
          </div>
          <div class="audit-col">
            <span class="audit-date">{{
              formatearFecha(clienteDetalle.clie_FechaModificacion ?? null)
            }}</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
